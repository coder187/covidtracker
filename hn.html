<!--Hussein Nasser-->
<!-- https://www.youtube.com/watch?v=rft4ZecPQcI&list=PLQnljOFTspQUppK8iiIuoQJTAj436IWQz&index=2 -->
<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>IGeometry-Head</title>

    <link rel="stylesheet" href="https://js.arcgis.com/4.19/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.19/"></script>
</head>
<body>
    <button id="mapSelect">Toggle Maps</button>
    <div id="mapview" style="width:500px;height:500px;">my map</div>

    <script>
        let map1;
        let map2;
        let map3;
        let mapView;
        let sceneView;

        //NOTE CANNOT HAVE SceneView & request together - an undefined error is thrown when calling the request
        //require(["esri/Map", "esri/views/MapView", "esri/views/SceneView", "esri/request","esri/layers/MapImageLayer" ],
        require(["esri/Map", "esri/views/MapView", "esri/request", "esri/layers/MapImageLayer"],
            function (Map, MapView, esriRequest, MapLayer) {
                map1 = new Map({ basemap: "topo" });
                map2 = new Map({ basemap: "satellite" });
                map3 = new Map({ basemap: "streets" });

                let viewOptions = {
                    container: "mapview", map: map3,
                    center: [-117.16139, 32.71274],
                    scale: 10000
                }


                let url = "https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer";

                var options = {
                    query: {
                        f: "json"
                    },
                    responseType: "json"
                };

                console.log("about to create promise");

                esriRequest(url, options).then(function (response) {
                    console.log("response", response);
                    alert(response.data.currentVersion);
                });

                mapView = new MapView(viewOptions);
                //sceneView = new SceneView(viewOptions);

                let layer = new MapLayer({ url: "https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer" })
                map3.add(layer);

                layer.when(function () {
                    mapView.goTo(layer.fullExtent);
                })

            }
        );

        document.getElementById("mapSelect").addEventListener("click", function () {
            if (mapView.map === map1) {
                mapView.map = map3;
            } else {
                mapView.map = map1;
            }

        })
    </script>

</body>
</html>